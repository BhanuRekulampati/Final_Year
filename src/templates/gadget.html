<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decision Making with AI</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* Dark theme background */
            color: #e2e8f0; /* Dark theme text color */
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Light theme overrides */
        body.light-mode {
            background-color: #f1f5f9; /* Light theme background */
            color: #1e293b; /* Light theme text color */
        }

        /* Custom styles for the animated background */
        .animated-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            pointer-events: none;
            background-image: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        body.light-mode .animated-background {
            background-image: linear-gradient(135deg, #cbd5e1 0%, #94a3b8 100%);
        }
        
        .animated-background .gadget-icon {
            position: absolute;
            opacity: 0.1;
            color: #a855f7;
            animation: move-gadget 25s linear infinite;
        }

        body.light-mode .animated-background .gadget-icon {
            color: #374151;
        }
        
        /* Specific animations for each flowing icon */
        .animated-background .mobile-icon {
            font-size: 8rem;
        }
        .animated-background .laptop-icon {
            font-size: 6rem;
        }
        .animated-background .other-icon {
            font-size: 7rem;
        }

        .animated-background .gadget-icon:nth-child(1) {
            top: 10%;
            left: 5%;
            animation-duration: 15s;
        }
        .animated-background .gadget-icon:nth-child(2) {
            top: 40%;
            left: 30%;
            animation-duration: 20s;
        }
        .animated-background .gadget-icon:nth-child(3) {
            top: 70%;
            left: 70%;
            animation-duration: 25s;
        }
        .animated-background .gadget-icon:nth-child(4) {
            top: 20%;
            left: 80%;
            animation-duration: 18s;
        }
        .animated-background .gadget-icon:nth-child(5) {
            top: 85%;
            left: 15%;
            animation-duration: 22s;
        }
        .animated-background .gadget-icon:nth-child(6) {
            top: 55%;
            left: 90%;
            animation-duration: 27s;
        }
        .animated-background .gadget-icon:nth-child(7) {
            top: 30%;
            left: 10%;
            animation-duration: 19s;
        }
        .animated-background .gadget-icon:nth-child(8) {
            top: 65%;
            left: 45%;
            animation-duration: 23s;
        }
        .animated-background .gadget-icon:nth-child(9) {
            top: 80%;
            left: 60%;
            animation-duration: 21s;
        }
        .animated-background .gadget-icon:nth-child(10) {
            top: 5%;
            left: 50%;
            animation-duration: 24s;
        }
        
        .animated-background .gadget-icon.hidden {
            display: none;
        }

        @keyframes move-gadget {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0.1;
            }
            50% {
                transform: translateY(-50vh) rotate(180deg);
                opacity: 0.2;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0.1;
            }
        }

        /* Styling for the main container and content cards */
        .main-container {
            background-color: #1f2937; /* Dark mode container */
            border-color: #374151;
            transition: all 0.3s ease;
        }

        .light-mode .main-container {
            background-color: #e2e8f0; /* Light mode container */
            border-color: #cbd5e1;
        }

        .input-field {
            background-color: #374151;
            border-color: #4b5563;
            color: #d1d5db;
        }

        .light-mode .input-field {
            background-color: #f8fafc;
            border-color: #e2e8f0;
            color: #1f2937;
        }

        .pros-card {
            background-color: #374151;
            border-color: #10b981; /* Green border for dark theme */
        }

        .light-mode .pros-card {
            background-color: #e2e8f0;
            border-color: #10b981; /* Green border for light theme */
        }

        .cons-card {
            background-color: #374151;
            border-color: #ef4444; /* Red border for dark theme */
        }

        .light-mode .cons-card {
            background-color: #e2e8f0;
            border-color: #ef4444; /* Red border for light theme */
        }

        .toggle-btn {
            background-color: #1f2937;
            color: #d1d5db;
            border-color: #4b5563;
        }

        .light-mode .toggle-btn {
            background-color: #f8fafc;
            color: #1f2937;
            border-color: #e2e8f0;
        }

        /* New styles for the suggestion module */
        .suggestion-card {
            background: #1e293b;
            border: 2px solid transparent;
            border-radius: 1.5rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease-in-out;
            cursor: pointer;
        }

        .light-mode .suggestion-card {
            background: #e2e8f0;
            color: #1e293b;
        }
        
        .suggestion-card:hover {
            border-color: #6366f1;
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(99, 102, 241, 0.5), 0 4px 6px -2px rgba(99, 102, 241, 0.2);
        }
        
        /* Ensures all text colors are readable in both themes */
        .text-gray-100 { color: #f3f4f6; }
        .light-mode .text-gray-100 { color: #1f2937; }

        .text-gray-200 { color: #e5e7eb; }
        .light-mode .text-gray-200 { color: #374151; }

        .text-gray-400 { color: #9ca3af; }
        .light-mode .text-gray-400 { color: #6b7280; }

        .text-gray-500 { color: #6b7280; }
        .light-mode .text-gray-500 { color: #4b5563; }
        
        .placeholder-text-dark {
            color: #94a3af;
        }
        
        .light-mode .placeholder-text-dark {
            color: #475569;
        }

        /* New styles for the buying guide container */
        .buying-guide-container {
            background-color: #1f2937;
            border-color: #374151;
            transition: all 0.3s ease;
        }

        .light-mode .buying-guide-container {
            background-color: #e2e8f0;
            border-color: #cbd5e1;
        }
        
        .buying-guide-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        
        .buying-guide-content.open {
            max-height: 1000px; /* A large value to allow for expansion */
        }
        
        /* New styling to remove default list bullets and create a custom one */
        .list-unstyled {
            list-style-type: none;
            padding-left: 0;
        }
        
        .list-unstyled li {
            position: relative;
            padding-left: 1rem;
            line-height: 1.5;
        }
        
        .list-unstyled li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.6rem;
            width: 0.3rem;
            height: 0.3rem;
            background-color: currentColor;
            border-radius: 50%;
        }
    </style>
</head>
<body class="bg-gray-900 min-h-screen flex flex-col items-center justify-center p-4">

    <!-- Animated Background -->
    <div class="animated-background">
        <!-- Mobile Icons -->
        <div class="gadget-icon mobile-icon" style="top: 10%; left: 5%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 2h10c1.1 0 2 .9 2 2v16c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2zM7 3c-.55 0-1 .45-1 1v16c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H7zm5 16c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path></svg>
        </div>
        <div class="gadget-icon mobile-icon" style="top: 40%; left: 30%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 2h10c1.1 0 2 .9 2 2v16c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2zM7 3c-.55 0-1 .45-1 1v16c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H7zm5 16c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path></svg>
        </div>
        <div class="gadget-icon mobile-icon" style="top: 70%; left: 70%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 2h10c1.1 0 2 .9 2 2v16c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2zM7 3c-.55 0-1 .45-1 1v16c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H7zm5 16c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path></svg>
        </div>
        <div class="gadget-icon mobile-icon" style="top: 20%; left: 80%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 2h10c1.1 0 2 .9 2 2v16c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2zM7 3c-.55 0-1 .45-1 1v16c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H7zm5 16c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path></svg>
        </div>
        <div class="gadget-icon mobile-icon" style="top: 85%; left: 15%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 2h10c1.1 0 2 .9 2 2v16c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2zM7 3c-.55 0-1 .45-1 1v16c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H7zm5 16c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path></svg>
        </div>

        <!-- Laptop Icons -->
        <div class="gadget-icon laptop-icon hidden" style="top: 55%; left: 90%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 18H3c-.55 0-1 .45-1 1s.45 1 1 1h18c.55 0 1-.45 1-1s-.45-1-1-1zm-1-9H4V4c0-.55-.45-1-1-1s-1 .45-1 1v6h20V4c0-.55-.45-1-1-1s-1 .45-1 1v5z"></path></svg>
        </div>
        <div class="gadget-icon laptop-icon hidden" style="top: 30%; left: 10%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 18H3c-.55 0-1 .45-1 1s.45 1 1 1h18c.55 0 1-.45 1-1s-.45-1-1-1zm-1-9H4V4c0-.55-.45-1-1-1s-1 .45-1 1v6h20V4c0-.55-.45-1-1-1s-1 .45-1 1v5z"></path></svg>
        </div>
        <div class="gadget-icon laptop-icon hidden" style="top: 65%; left: 45%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 18H3c-.55 0-1 .45-1 1s.45 1 1 1h18c.55 0 1-.45 1-1s-.45-1-1-1zm-1-9H4V4c0-.55-.45-1-1-1s-1 .45-1 1v6h20V4c0-.55-.45-1-1-1s-1 .45-1 1v5z"></path></svg>
        </div>

        <!-- Other Icons (represented by a generic chat icon) -->
        <div class="gadget-icon other-icon hidden" style="top: 80%; left: 60%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2c-3.86 0-7 3.14-7 7s3.14 7 7 7c.48 0 .95-.06 1.4-.17L19 22l-1.9-5.7c1.37-1.34 2.2-3.14 2.2-5.13 0-3.86-3.14-7-7-7zm0 2c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5z"></path></svg>
        </div>
        <div class="gadget-icon other-icon hidden" style="top: 5%; left: 50%;">
            <svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2c-3.86 0-7 3.14-7 7s3.14 7 7 7c.48 0 .95-.06 1.4-.17L19 22l-1.9-5.7c1.37-1.34 2.2-3.14 2.2-5.13 0-3.86-3.14-7-7-7zm0 2c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5z"></path></svg>
        </div>
    </div>

    <div class="flex-grow flex flex-col items-center justify-center w-full">
        <!-- Main Container -->
        <div class="w-full max-w-2xl bg-gray-800 rounded-2xl shadow-2xl overflow-hidden p-6 md:p-10 border border-gray-700 relative z-10 main-container">

            <!-- Header -->
            <header class="text-center mb-8 flex justify-between items-center">
                <h1 class="text-3xl md:text-4xl font-extrabold text-gray-100 mb-2">Decision Making with AI</h1>
                <button id="themeToggleBtn" class="toggle-btn p-2 rounded-full border shadow-md">
                    <svg id="moonIcon" class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                    </svg>
                    <svg id="sunIcon" class="w-6 h-6 text-yellow-500 hidden" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95a1 1 0 00.707.293h1a1 1 0 000-2h-1a1 1 0 00-.707.293l-.707.707zm-8.486-8.485a1 1 0 00-.707-.293H2a1 1 0 000 2h1a1 1 0 00.707-.293l.707-.707zm11.314 0l.707-.707A1 1 0 0015 2.586V2h-1a1 1 0 00-1 1v1a1 1 0 001 1h1.414l.707-.707zm-11.314 8.485l-.707.707A1 1 0 005 17.414V18h1a1 1 0 001-1v-1a1 1 0 00-1-1H4.414l-.707.707zM10 18a1 1 0 011-1h1a1 1 0 110 2h-1a1 1 0 01-1-1zm-4-1a1 1 0 001 1v1a1 1 0 11-2 0v-1a1 1 0 001-1z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </header>
            <p class="text-gray-400 text-lg text-center -mt-6 mb-8">Your smart assistant for gadget purchases.</p>

            <!-- Input and Button Section -->
            <div class="flex flex-col sm:flex-row gap-4 mb-8">
                <select id="gadgetCategory" class="p-3 md:p-4 rounded-xl bg-gray-700 text-gray-200 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all duration-200 shadow-sm input-field">
                    <option value="mobile">Mobile</option>
                    <option value="laptop">Laptop</option>
                    <option value="other">Other</option>
                </select>
                <input type="text" id="gadgetInput" placeholder="e.g., iPhone 15 Pro, PlayStation 5" class="flex-1 p-3 md:p-4 rounded-xl bg-gray-700 text-gray-200 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all duration-200 shadow-sm placeholder-gray-400 input-field">
                <button id="analyzeBtn" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 active:scale-95">
                    Analyze Gadget
                </button>
            </div>
            
            <!-- Loading Indicator -->
            <div id="loading" class="hidden flex flex-col items-center justify-center p-8 bg-gray-700 rounded-xl transition-all duration-300">
                <svg class="animate-spin h-8 w-8 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <p id="loadingText" class="mt-4 text-indigo-500 font-semibold">Analyzing the current market...</p>
            </div>
            
            <!-- Suggested Gadget Module (Initially hidden) -->
            <div id="suggestionModule" class="hidden text-center mb-8">
                <p class="text-gray-400 mb-4">The selected model is outdated. You might be interested in a newer one:</p>
                <div id="suggestedGadgetCard" class="suggestion-card flex items-center justify-between p-4">
                    <span id="suggestedGadgetName" class="text-lg font-semibold text-gray-100 placeholder-text-dark"></span>
                    <button id="analyzeSuggestedBtn" class="bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700 transition-all duration-300">
                        Analyze This
                    </button>
                </div>
            </div>
            
            <!-- Results Section -->
            <div id="results" class="hidden grid grid-cols-1 md:grid-cols-2 gap-6 transition-all duration-500 ease-in-out">
                <!-- Pros Card -->
                <div class="bg-gray-700 border border-green-500 rounded-2xl p-6 shadow-md pros-card">
                    <h2 class="text-2xl font-bold text-green-400 mb-4 flex items-center">
                        <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        Pros
                    </h2>
                    <ul id="prosList" class="space-y-3 text-gray-200">
                        <!-- Pros will be dynamically inserted here -->
                    </ul>
                </div>
                <!-- Cons Card -->
                <div class="bg-gray-700 border border-red-500 rounded-2xl p-6 shadow-md cons-card">
                    <h2 class="text-2xl font-bold text-red-400 mb-4 flex items-center">
                        <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        Cons
                    </h2>
                    <ul id="consList" class="space-y-3 text-gray-200">
                        <!-- Cons will be dynamically inserted here -->
                    </ul>
                </div>
            </div>

            <!-- Error Message -->
            <div id="errorMsg" class="hidden bg-red-800 border border-red-500 text-red-200 px-4 py-3 rounded-xl relative mt-6" role="alert">
                <span class="block sm:inline">An error occurred. Please try again.</span>
            </div>
            
        </div>
        
        <!-- Buying Guide Module -->
        <div id="buyingGuideContainer" class="w-full max-w-2xl mt-8 bg-gray-800 rounded-2xl shadow-xl overflow-hidden buying-guide-container">
            <button id="buyingGuideToggle" class="w-full flex justify-between items-center p-6 cursor-pointer focus:outline-none">
                <h2 class="text-2xl font-bold text-gray-100">Buying Guide</h2>
                <svg id="toggleIcon" class="w-6 h-6 transform rotate-0 transition-transform duration-300" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                </svg>
            </button>
            <div id="buyingGuideContent" class="buying-guide-content p-6 border-t border-gray-700">
                <div class="space-y-8">
                    <div>
                        <h3 class="text-xl font-semibold text-gray-100 mb-2">Mobiles</h3>
                        <p class="text-gray-400">When buying a mobile phone, consider these key specs:</p>
                        <ul class="list-unstyled space-y-2 text-gray-400 mt-2">
                            <li>*Processor:* The brain of the phone. Look for a recent Snapdragon, A-series (for iPhones), or Tensor (for Google Pixels) chip for a smooth experience.</li>
                            <li>*RAM & Storage:* 8GB of RAM is good, 12GB is great for multitasking. 128GB of storage is the minimum, but 256GB is recommended.</li>
                            <li>*Battery (mAh):* A higher mAh number means a longer battery life. Aim for at least 4500mAh for all-day use.</li>
                            <li>*Display:* OLED and AMOLED screens offer vibrant colors and deep blacks. Look for a high refresh rate (90Hz or 120Hz) for a smoother feel.</li>
                            <li>*Camera (MP):* More megapixels don't always mean a better photo, but a higher number (e.g., 50MP) often indicates a larger sensor for better low-light performance.</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-semibold text-gray-100 mb-2">Laptops</h3>
                        <p class="text-gray-400">For laptops, your choice depends on your use case:</p>
                        <ul class="list-unstyled space-y-2 text-gray-400 mt-2">
                            <li>*Processor (CPU):* Intel Core i5 or AMD Ryzen 5 is good for general use. For heavy tasks like gaming or video editing, choose an i7/Ryzen 7 or higher.</li>
                            <li>*RAM:* 16GB is the modern standard for smooth multitasking. 8GB can work but may feel slow.</li>
                            <li>*Storage:* An SSD (Solid State Drive) is a must for fast boot times and app loading. Aim for at least 512GB.</li>
                            <li>*Display:* A high-resolution screen (Full HD or higher) is a good starting point. For creative work, look for an OLED or a high color-accuracy display.</li>
                            <li>*Graphics (GPU):* An integrated GPU (like Intel Iris Xe) is fine for light use. For gaming or demanding tasks, look for a dedicated NVIDIA GeForce or AMD Radeon GPU.</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-semibold text-gray-100 mb-2">Other Gadgets (e.g., Tablets, Smartwatches)</h3>
                        <p class="text-gray-400">When shopping for other devices, focus on these areas:</p>
                        <ul class="list-unstyled space-y-2 text-gray-400 mt-2">
                            <li>*Screen Size:* Choose a size that fits your needs, whether for portability (smaller tablets) or media consumption (larger ones).</li>
                            <li>*Operating System:* This dictates the apps you can use. Apple's iPadOS and Google's Android are the main choices for tablets, each with its own ecosystem.</li>
                            <li>*Battery Life:* For smartwatches and tablets, look for a device that can last for at least a full day on a single charge.</li>
                            <li>*Ecosystem Compatibility:* Make sure the device you choose works well with your other gadgets, like your smartphone and laptop.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="mt-8 text-center text-gray-500 text-sm relative z-10">
        <p>&copy; 2025 AI Decision Maker. A final year project demonstrating AI-driven RAG.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const gadgetInput = document.getElementById('gadgetInput');
            const gadgetCategory = document.getElementById('gadgetCategory');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loading = document.getElementById('loading');
            const loadingText = document.getElementById('loadingText');
            const results = document.getElementById('results');
            const prosList = document.getElementById('prosList');
            const consList = document.getElementById('consList');
            const errorMsg = document.getElementById('errorMsg');
            const themeToggleBtn = document.getElementById('themeToggleBtn');
            const sunIcon = document.getElementById('sunIcon');
            const moonIcon = document.getElementById('moonIcon');
            const body = document.body;
            const suggestionModule = document.getElementById('suggestionModule');
            const suggestedGadgetName = document.getElementById('suggestedGadgetName');
            const analyzeSuggestedBtn = document.getElementById('analyzeSuggestedBtn');
            const gadgetIcons = document.querySelectorAll('.gadget-icon');
            const buyingGuideToggle = document.getElementById('buyingGuideToggle');
            const buyingGuideContent = document.getElementById('buyingGuideContent');
            const toggleIcon = document.getElementById('toggleIcon');


            // Theme toggle logic
            themeToggleBtn.addEventListener('click', () => {
                body.classList.toggle('light-mode');
                sunIcon.classList.toggle('hidden');
                moonIcon.classList.toggle('hidden');
            });
            
            // Buying guide toggle logic
            buyingGuideToggle.addEventListener('click', () => {
                buyingGuideContent.classList.toggle('open');
                toggleIcon.classList.toggle('rotate-180');
            });

            // Update background icons based on category selection
            gadgetCategory.addEventListener('change', (event) => {
                const selectedCategory = event.target.value;
                gadgetIcons.forEach(icon => {
                    icon.classList.add('hidden');
                });
                document.querySelectorAll(`.${selectedCategory}-icon`).forEach(icon => {
                    icon.classList.remove('hidden');
                });
            });

            // Initial state: show mobile icons by default
            document.querySelectorAll('.mobile-icon').forEach(icon => {
                icon.classList.remove('hidden');
            });

            // Handle analysis for the suggested gadget
            analyzeSuggestedBtn.addEventListener('click', () => {
                const suggestedName = suggestedGadgetName.textContent.trim();
                gadgetInput.value = suggestedName;
                analyzeGadget(suggestedName, gadgetCategory.value);
                suggestionModule.classList.add('hidden');
            });
            
            analyzeBtn.addEventListener('click', () => {
                const gadget = gadgetInput.value.trim();
                const category = gadgetCategory.value;
                analyzeGadget(gadget, category);
            });

            async function analyzeGadget(gadget, category) {
                if (!gadget) {
                    errorMsg.textContent = 'Please enter a gadget name to analyze.';
                    errorMsg.classList.remove('hidden');
                    results.classList.add('hidden');
                    return;
                }

                results.classList.add('hidden');
                errorMsg.classList.add('hidden');
                suggestionModule.classList.add('hidden');
                loadingText.textContent = `Analyzing ${gadget}...`;
                loading.classList.remove('hidden');

                const backendUrl = '/analyze_gadget'; 

                try {
                    const response = await fetch(backendUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ gadget: gadget, category: category })
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || `API error: ${response.status} ${response.statusText}`);
                    }
                    
                    const result = await response.json();
                    
                    const data = JSON.parse(result.data);
                    
                    prosList.innerHTML = '';
                    consList.innerHTML = '';
                    
                    data.pros.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = item;
                        li.classList.add('flex', 'items-start', 'text-sm');
                        const icon = document.createElement('span');
                        icon.textContent = '✓';
                        icon.classList.add('text-green-400', 'font-bold', 'mr-2');
                        li.prepend(icon);
                        prosList.appendChild(li);
                    });
                    
                    data.cons.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = item;
                        li.classList.add('flex', 'items-start', 'text-sm');
                        const icon = document.createElement('span');
                        icon.textContent = '✗';
                        icon.classList.add('text-red-400', 'font-bold', 'mr-2');
                        li.prepend(icon);
                        consList.appendChild(li);
                    });
                    
                    results.classList.remove('hidden');
                    
                    // Display the suggestion module if the backend sends a suggestion
                    if (result.suggestion) {
                        suggestedGadgetName.textContent = result.suggested_phone;
                        suggestionModule.classList.remove('hidden');
                    } else {
                        suggestionModule.classList.add('hidden');
                    }

                } catch (error) {
                    console.error('Error fetching data:', error);
                    errorMsg.textContent = `Sorry, an error occurred. Please try a different gadget. Details: ${error.message}`;
                    errorMsg.classList.remove('hidden');
                } finally {
                    loading.classList.add('hidden');
                }
            }
        });
    </script>
</body>
</html>
